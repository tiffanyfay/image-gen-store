apiVersion: batch/v1
kind: Job
metadata:
  name: image-gen-store-$RANDOM_STRING
  namespace: gen
spec:
  template:
    metadata:
      annotations:
        prompt: $AI_PROMPT
    spec:
      restartPolicy: Never
      containers:
        - name: image-gen-store
          image: $IMAGE_GEN_STORE_IMAGE
          args:
            - $AI_PROMPT
          env:
            - name: DB_SERVICE_URL
              value: $DB_SERVICE_URL
            - name: AI_PROMPT
              value: $AI_PROMPT
            - name: OPENAI_API_KEY
              valueFrom:
                secretKeyRef:
                  name: openai-api-key
                  key: key